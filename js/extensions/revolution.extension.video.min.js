/********************************************
 * REVOLUTION 5.0 EXTENSION - VIDEO FUNCTIONS
 * @version: 1.1.0 (01.10.2015)
 * @requires jquery.themepunch.revolution.js
 * @author ThemePunch
 *********************************************/
!function(){function e(e){return null==e?-1:jQuery.isNumeric(e)?e:1<e.split(":").length?60*parseInt(e.split(":")[0],0)+parseInt(e.split(":")[1],0):e}var t=jQuery.fn.revolution,a=t.is_mobile();jQuery.extend(!0,t,{resetVideo:function(t){switch(t.data("videotype")){case"youtube":t.data("player");try{"on"!=t.data("forcerewind")||a||(n=-1==(n=e(t.data("videostartat")))?0:n,t.data("player").seekTo(n),t.data("player").pauseVideo())}catch(t){}0==t.find(".tp-videoposter").length&&punchgs.TweenLite.to(t.find("iframe"),.3,{autoAlpha:1,display:"block",ease:punchgs.Power3.easeInOut});break;case"vimeo":var i=$f(t.find("iframe").attr("id"));try{"on"!=t.data("forcerewind")||a||(n=-1==(n=e(t.data("videostartat")))?0:n,i.api("seekTo",n),i.api("pause"))}catch(t){}0==t.find(".tp-videoposter").length&&punchgs.TweenLite.to(t.find("iframe"),.3,{autoAlpha:1,display:"block",ease:punchgs.Power3.easeInOut});break;case"html5":if(a&&1==t.data("disablevideoonmobile"))return!1;var o=t.find("video"),d=o[0];if(punchgs.TweenLite.to(o,.3,{autoAlpha:1,display:"block",ease:punchgs.Power3.easeInOut}),"on"==t.data("forcerewind")&&!t.hasClass("videoisplaying"))try{var n=e(t.data("videostartat"));d.currentTime=-1==n?0:n}catch(t){}"mute"==t.data("volume")&&(d.muted=!0)}},stopVideo:function(e){switch(e.data("videotype")){case"youtube":try{e.data("player").pauseVideo()}catch(e){}break;case"vimeo":try{$f(e.find("iframe").attr("id")).api("pause")}catch(e){}break;case"html5":e.find("video")[0].pause()}},playVideo:function(o,n){switch(clearTimeout(o.data("videoplaywait")),o.data("videotype")){case"youtube":0==o.find("iframe").length?(o.append(o.data("videomarkup")),d(o,n,!0)):null!=o.data("player").playVideo?(o.data("player").playVideo(),-1!=(l=e(o.data("videostartat")))&&o.data("player").seekTo(l)):o.data("videoplaywait",setTimeout(function(){t.playVideo(o,n)},50));break;case"vimeo":if(0==o.find("iframe").length)o.append(o.data("videomarkup")),d(o,n,!0);else if(o.hasClass("rs-apiready")){var r=o.find("iframe").attr("id"),s=$f(r);null==s.api("play")?o.data("videoplaywait",setTimeout(function(){t.playVideo(o,n)},50)):setTimeout(function(){s.api("play");var t=e(o.data("videostartat"));-1!=t&&s.api("seekTo",t)},510)}else o.data("videoplaywait",setTimeout(function(){t.playVideo(o,n)},50));break;case"html5":if(a&&1==o.data("disablevideoonmobile"))return!1;var l,p=o.find("video"),u=p[0];1!=p.parent().data("metaloaded")?i(u,"loadedmetadata",function(a){t.resetVideo(a,n),u.play();var i=e(a.data("videostartat"));-1!=i&&(u.currentTime=i)}(o)):(u.play(),-1!=(l=e(o.data("videostartat")))&&(u.currentTime=l))}},isVideoPlaying:function(e,t){var a=!1;return null!=t.playingvideos&&jQuery.each(t.playingvideos,function(t,i){e.attr("id")==i.attr("id")&&(a=!0)}),a},prepareCoveredVideo:function(e,t,a){var i=a.find("iframe, video"),o=e.split(":")[0],d=e.split(":")[1],n=a.closest(".tp-revslider-slidesli"),r=n.width()/n.height(),s=o/d,l=r/s*100,p=s/r*100;s<r?punchgs.TweenLite.to(i,.001,{height:l+"%",width:"100%",top:-(l-100)/2+"%",left:"0px",position:"absolute"}):punchgs.TweenLite.to(i,.001,{width:p+"%",height:"100%",left:-(p-100)/2+"%",top:"0px",position:"absolute"})},checkVideoApis:function(e,t,a){var i="https:"===location.protocol?"https":"http";if((null!=e.data("ytid")||0<e.find("iframe").length&&0<e.find("iframe").attr("src").toLowerCase().indexOf("youtube"))&&(t.youtubeapineeded=!0),(null!=e.data("ytid")||0<e.find("iframe").length&&0<e.find("iframe").attr("src").toLowerCase().indexOf("youtube"))&&0==a.addedyt){t.youtubestarttime=jQuery.now(),a.addedyt=1;var o=document.createElement("script");o.src="https://www.youtube.com/iframe_api";var d=document.getElementsByTagName("script")[0],n=!0;jQuery("head").find("*").each(function(){"https://www.youtube.com/iframe_api"==jQuery(this).attr("src")&&(n=!1)}),n&&d.parentNode.insertBefore(o,d)}if((null!=e.data("vimeoid")||0<e.find("iframe").length&&0<e.find("iframe").attr("src").toLowerCase().indexOf("vimeo"))&&(t.vimeoapineeded=!0),(null!=e.data("vimeoid")||0<e.find("iframe").length&&0<e.find("iframe").attr("src").toLowerCase().indexOf("vimeo"))&&0==a.addedvim){t.vimeostarttime=jQuery.now(),a.addedvim=1;var r=document.createElement("script");d=document.getElementsByTagName("script")[0],n=!0,r.src=i+"://f.vimeocdn.com/js/froogaloop2.min.js",jQuery("head").find("*").each(function(){jQuery(this).attr("src")==i+"://a.vimeocdn.com/js/froogaloop2.min.js"&&(n=!1)}),n&&d.parentNode.insertBefore(r,d)}return a},manageVideoLayer:function(o,r){var s=o.data("videoattributes"),l=o.data("ytid"),p=o.data("vimeoid"),u=o.data("videpreload"),v=o.data("videomp4"),c=o.data("videowebm"),f=o.data("videoogv"),h=o.data("allowfullscreenvideo"),m=o.data("videocontrols"),y="http",g="loop"==o.data("videoloop")?"loop":"loopandnoslidestop"==o.data("videoloop")?"loop":"",w=null!=v||null!=c?"html5":null!=l&&1<String(l).length?"youtube":null!=p&&1<String(p).length?"vimeo":"none",b="html5"==w&&0==o.find("video").length?"html5":"youtube"==w&&0==o.find("iframe").length?"youtube":"vimeo"==w&&0==o.find("iframe").length?"vimeo":"none";switch(o.data("videotype",w),b){case"html5":"controls"!=m&&(m="");var k='<video style="object-fit:cover;background-size:cover;visible:hidden;width:100%; height:100%" class="" '+g+' preload="'+u+'" playsinline loop="loop" muted="muted" autoplay="autoplay" >';null!=c&&"firefox"==t.get_browser().toLowerCase()&&(k=k+'<source src="'+c+'" type="video/webm" />'),null!=v&&(k=k+'<source src="'+v+'" type="video/mp4" />'),null!=f&&(k=k+'<source src="'+f+'" type="video/ogg" />'),k+="</video>";var T="";("true"===h||!0===h)&&(T='<div class="tp-video-button-wrap hidden"><span class="tp-video-button tp-vid-full-screen">Full-Screen</span></div>'),"controls"==m&&(k+='<div class="tp-video-controls"><div class="tp-video-button-wrap"><button type="button" class="tp-video-button tp-vid-play-pause">Play</button></div><div class="tp-video-seek-bar-wrap hidden"><input aria-hidden="true" type="range" class="tp-seek-bar" value="0"></div><div class="tp-video-button-wrap hidden"><span aria-hidden="true" class="tp-video-button tp-vid-mute">Mute</span></div><div class="tp-video-vol-bar-wrap hidden"><input aria-hidden="true" type="range" class="tp-volume-bar" min="0" max="1" step="0.1" value="1"></div>'+T+"</div>"),o.data("videomarkup",k),o.append(k),(a&&1==o.data("disablevideoonmobile")||t.isIE(8))&&o.find("video").remove(),o.find("video").each(function(){var e,a=jQuery(this);a.parent().hasClass("html5vid")||a.wrap('<div class="html5vid" style="position:relative;top:0px;left:0px;width:100%;height:100%; overflow:hidden;"></div>'),1!=a.parent().data("metaloaded")&&i(this,"loadedmetadata",(n(e=o,r),void t.resetVideo(e,r)))});break;case"youtube":y="http","https:"===location.protocol&&(y="https"),"none"==m&&-1==(s=s.replace("controls=1","controls=0")).toLowerCase().indexOf("controls")&&(s+="&controls=0");var x=e(o.data("videostartat")),L=e(o.data("videoendat"));-1!=x&&(s=s+"&start="+x),-1!=L&&(s=s+"&end="+L);var C=s.split("origin="+y+"://"),V="";1<C.length?(V=C[0]+"origin="+y+"://",self.location.href.match(/www/gi)&&!C[1].match(/www/gi)&&(V+="www."),V+=C[1]):V=s;var P="true"===h||!0===h?"allowfullscreen":"";o.data("videomarkup",'<iframe style="visible:hidden" src="'+y+"://www.youtube.com/embed/"+l+"?"+V+'" '+P+' width="100%" height="100%" style="width:100%;height:100%"></iframe>');break;case"vimeo":"https:"===location.protocol&&(y="https"),o.data("videomarkup",'<iframe style="visible:hidden" src="'+y+"://player.vimeo.com/video/"+p+"?"+s+'" width="100%" height="100%" style="100%;height:100%"></iframe>')}var I=1!=a&&"on"!=o.data("posterOnMobile")&&"on"!=o.data("posteronmobile")||a;null!=o.data("videoposter")&&2<o.data("videoposter").length&&I?(0==o.find(".tp-videoposter").length&&o.append('<div class="tp-videoposter noSwipe" style="cursor:pointer; position:absolute;top:0px;left:0px;width:100%;height:100%;z-index:3;background-image:url('+o.data("videoposter")+'); background-size:cover;background-position:center center;"></div>'),0==o.find("iframe").length&&o.find(".tp-videoposter").click(function(){if(t.playVideo(o,r),a){if(1==o.data("disablevideoonmobile"))return!1;punchgs.TweenLite.to(o.find(".tp-videoposter"),.3,{autoAlpha:0,force3D:"auto",ease:punchgs.Power3.easeInOut}),punchgs.TweenLite.to(o.find("iframe"),.3,{autoAlpha:1,display:"block",ease:punchgs.Power3.easeInOut})}})):0!=o.find("iframe").length||"youtube"!=w&&"vimeo"!=w||(o.append(o.data("videomarkup")),d(o,r,!1)),"none"!=o.data("dottedoverlay")&&null!=o.data("dottedoverlay")&&1!=o.find(".tp-dottedoverlay").length&&o.append('<div class="tp-dottedoverlay '+o.data("dottedoverlay")+'"></div>'),o.addClass("HasListener"),1==o.data("bgvideo")&&punchgs.TweenLite.set(o.find("video, iframe"),{autoAlpha:0})}});var i=function(e,t,a){e.addEventListener?e.addEventListener(t,a,!1):e.attachEvent(t,a,!1)},o=function(e,t,a){var i={};return i.video=e,i.videotype=t,i.settings=a,i},d=function(i,d,n){var l=i.find("iframe"),p="iframe"+Math.round(1e5*Math.random()+1),u=i.data("videoloop"),v="loopandnoslidestop"!=u;if(u="loop"==u||"loopandnoslidestop"==u,1==i.data("forcecover")){i.removeClass("fullscreenvideo").addClass("coverscreenvideo");var c=i.data("aspectratio");null!=c&&1<c.split(":").length&&t.prepareCoveredVideo(c,d,i)}if(l.attr("id",p),n&&i.data("startvideonow",!0),1!==i.data("videolistenerexist"))switch(i.data("videotype")){case"youtube":var f=new YT.Player(p,{events:{onStateChange:function(t){var a=t.target.getVideoEmbedCode(),i=jQuery("#"+a.split('id="')[1].split('"')[0]),n=i.closest(".tp-simpleresponsive"),l=i.parent(),p=i.parent().data("player");if(t.data==YT.PlayerState.PLAYING)punchgs.TweenLite.to(l.find(".tp-videoposter"),.3,{autoAlpha:0,force3D:"auto",ease:punchgs.Power3.easeInOut}),punchgs.TweenLite.to(l.find("iframe"),.3,{autoAlpha:1,display:"block",ease:punchgs.Power3.easeInOut}),"mute"==l.data("volume")?p.mute():(p.unMute(),p.setVolume(parseInt(l.data("volume"),0)||75)),d.videoplaying=!0,r(l,d),n.trigger("stoptimer"),d.c.trigger("revolution.slide.onvideoplay",o(p,"youtube",l.data()));else{if(0==t.data&&u){var v=e(l.data("videostartat"));-1!=v&&p.seekTo(v),p.playVideo()}(0==t.data||2==t.data)&&"on"==l.data("showcoveronpause")&&0<l.find(".tp-videoposter").length&&(punchgs.TweenLite.to(l.find(".tp-videoposter"),.3,{autoAlpha:1,force3D:"auto",ease:punchgs.Power3.easeInOut}),punchgs.TweenLite.to(l.find("iframe"),.3,{autoAlpha:0,ease:punchgs.Power3.easeInOut})),-1!=t.data&&3!=t.data&&(d.videoplaying=!1,s(l,d),n.trigger("starttimer"),d.c.trigger("revolution.slide.onvideostop",o(p,"youtube",l.data()))),0==t.data&&1==l.data("nextslideatend")?(d.c.revnext(),s(l,d)):(s(l,d),d.videoplaying=!1,n.trigger("starttimer"),d.c.trigger("revolution.slide.onvideostop",o(p,"youtube",l.data())))}},onReady:function(t){var i=t.target.getVideoEmbedCode(),o=jQuery("#"+i.split('id="')[1].split('"')[0]).parent(),d=o.data("videorate");if(o.data("videostart"),o.addClass("rs-apiready"),null!=d&&t.target.setPlaybackRate(parseFloat(d)),o.find(".tp-videoposter").unbind("click"),o.find(".tp-videoposter").click(function(){a||f.playVideo()}),o.data("startvideonow")){o.data("player").playVideo();var n=e(o.data("videostartat"));-1!=n&&o.data("player").seekTo(n)}o.data("videolistenerexist",1)}}});i.data("player",f);break;case"vimeo":for(var h,m=l.attr("src"),y={},g=m,w=/([^&=]+)=([^&]*)/g;h=w.exec(g);)y[decodeURIComponent(h[1])]=decodeURIComponent(h[2]);m=null!=y.player_id?m.replace(y.player_id,p):m+"&player_id="+p;try{m=m.replace("api=0","api=1")}catch(n){}m+="&api=1",l.attr("src",m),f=i.find("iframe")[0],(jQuery("#"+p),k=$f(p)).addEvent("ready",function(){if(i.addClass("rs-apiready"),k.addEvent("play",function(){i.data("nextslidecalled",0),punchgs.TweenLite.to(i.find(".tp-videoposter"),.3,{autoAlpha:0,force3D:"auto",ease:punchgs.Power3.easeInOut}),punchgs.TweenLite.to(i.find("iframe"),.3,{autoAlpha:1,display:"block",ease:punchgs.Power3.easeInOut}),d.c.trigger("revolution.slide.onvideoplay",o(k,"vimeo",i.data())),d.videoplaying=!0,r(i,d),v&&d.c.trigger("stoptimer"),"mute"==i.data("volume")?k.api("setVolume","0"):k.api("setVolume",parseInt(i.data("volume"),0)/100||.75)}),k.addEvent("playProgress",function(t){var a=e(i.data("videoendat"));if(0!=a&&Math.abs(a-t.seconds)<.3&&a>t.seconds&&1!=i.data("nextslidecalled"))if(u){k.api("play");var o=e(i.data("videostartat"));-1!=o&&k.api("seekTo",o)}else 1==i.data("nextslideatend")&&(i.data("nextslidecalled",1),d.c.revnext()),k.api("pause")}),k.addEvent("finish",function(){s(i,d),d.videoplaying=!1,d.c.trigger("starttimer"),d.c.trigger("revolution.slide.onvideostop",o(k,"vimeo",i.data())),1==i.data("nextslideatend")&&d.c.revnext()}),k.addEvent("pause",function(){0<i.find(".tp-videoposter").length&&"on"==i.data("showcoveronpause")&&(punchgs.TweenLite.to(i.find(".tp-videoposter"),.3,{autoAlpha:1,force3D:"auto",ease:punchgs.Power3.easeInOut}),punchgs.TweenLite.to(i.find("iframe"),.3,{autoAlpha:0,ease:punchgs.Power3.easeInOut})),d.videoplaying=!1,s(i,d),d.c.trigger("starttimer"),d.c.trigger("revolution.slide.onvideostop",o(k,"vimeo",i.data()))}),i.find(".tp-videoposter").unbind("click"),i.find(".tp-videoposter").click(function(){return a?void 0:(k.api("play"),!1)}),i.data("startvideonow")){k.api("play");var t=e(i.data("videostartat"));-1!=t&&k.api("seekTo",t)}i.data("videolistenerexist",1)})}else{var b=e(i.data("videostartat"));switch(i.data("videotype")){case"youtube":n&&(i.data("player").playVideo(),-1!=b&&i.data("player").seekTo());break;case"vimeo":var k;n&&((k=$f(i.find("iframe").attr("id"))).api("play"),-1!=b&&k.api("seekTo",b))}}},n=function(d,n){if(a&&1==d.data("disablevideoonmobile"))return!1;var l=d.find("video"),p=l[0],u=l.parent(),v=d.data("videoloop"),c="loopandnoslidestop"!=v;if(v="loop"==v||"loopandnoslidestop"==v,u.data("metaloaded",1),null==l.attr("control")&&(0!=d.find(".tp-video-play-button").length||a||d.append('<div class="tp-video-play-button hidden"><i class="revicon-right-dir"></i><span class="tp-revstop">&nbsp;</span></div>'),d.find("video, .tp-poster, .tp-video-play-button").click(function(){d.hasClass("videoisplaying")?p.pause():p.play()})),1==d.data("forcecover")||d.hasClass("fullscreenvideo"))if(1==d.data("forcecover")){u.addClass("fullcoveredvideo");var f=d.data("aspectratio");t.prepareCoveredVideo(f,n,d)}else u.addClass("fullscreenvideo");var h=d.find(".tp-vid-play-pause")[0],m=d.find(".tp-vid-mute")[0],y=d.find(".tp-vid-full-screen")[0],g=d.find(".tp-seek-bar")[0],w=d.find(".tp-volume-bar")[0];null!=h&&(i(h,"click",function(){1==p.paused?p.play():p.pause()}),i(m,"click",function(){0==p.muted?(p.muted=!0,m.innerHTML="Unmute"):(p.muted=!1,m.innerHTML="Mute")}),y&&i(y,"click",function(){p.requestFullscreen?p.requestFullscreen():p.mozRequestFullScreen?p.mozRequestFullScreen():p.webkitRequestFullscreen&&p.webkitRequestFullscreen()}),i(g,"change",function(){var e=p.duration*(g.value/100);p.currentTime=e}),i(p,"timeupdate",function(){var t=100/p.duration*p.currentTime,a=e(d.data("videoendat")),i=p.currentTime;if(g.value=t,0!=a&&Math.abs(a-i)<=.3&&i<a&&1!=d.data("nextslidecalled"))if(v){p.play();var o=e(d.data("videostartat"));-1!=o&&(p.currentTime=o)}else 1==d.data("nextslideatend")&&(d.data("nextslidecalled",1),n.c.revnext()),p.pause()}),i(g,"mousedown",function(){d.addClass("seekbardragged"),p.pause()}),i(g,"mouseup",function(){d.removeClass("seekbardragged"),p.play()}),i(w,"change",function(){p.volume=w.value})),i(p,"play",function(){d.data("nextslidecalled",0),"mute"==d.data("volume")&&(p.muted=!0),d.addClass("videoisplaying"),r(d,n),c?(n.videoplaying=!0,n.c.trigger("stoptimer"),n.c.trigger("revolution.slide.onvideoplay",o(p,"html5",d.data()))):(n.videoplaying=!1,n.c.trigger("starttimer"),n.c.trigger("revolution.slide.onvideostop",o(p,"html5",d.data()))),punchgs.TweenLite.to(d.find(".tp-videoposter"),.3,{autoAlpha:0,force3D:"auto",ease:punchgs.Power3.easeInOut}),punchgs.TweenLite.to(d.find("video"),.3,{autoAlpha:1,display:"block",ease:punchgs.Power3.easeInOut});var e=d.find(".tp-vid-play-pause")[0],t=d.find(".tp-vid-mute")[0];null!=e&&(e.innerHTML="Pause"),null!=t&&p.muted&&(t.innerHTML="Unmute")}),i(p,"pause",function(){0<d.find(".tp-videoposter").length&&"on"==d.data("showcoveronpause")&&!d.hasClass("seekbardragged")&&(punchgs.TweenLite.to(d.find(".tp-videoposter"),.3,{autoAlpha:1,force3D:"auto",ease:punchgs.Power3.easeInOut}),punchgs.TweenLite.to(d.find("video"),.3,{autoAlpha:0,ease:punchgs.Power3.easeInOut})),d.removeClass("videoisplaying"),n.videoplaying=!1,s(d,n),n.c.trigger("starttimer"),n.c.trigger("revolution.slide.onvideostop",o(p,"html5",d.data()));var e=d.find(".tp-vid-play-pause")[0];null!=e&&(e.innerHTML="Play")}),i(p,"ended",function(){s(d,n),n.videoplaying=!1,s(d,n),n.c.trigger("starttimer"),n.c.trigger("revolution.slide.onvideostop",o(p,"html5",d.data())),1==d.data("nextslideatend")&&n.c.revnext(),d.removeClass("videoisplaying")})},r=function(e,a){null==a.playingvideos&&(a.playingvideos=new Array),e.data("stopallvideos")&&null!=a.playingvideos&&0<a.playingvideos.length&&(a.lastplayedvideos=jQuery.extend(!0,[],a.playingvideos),jQuery.each(a.playingvideos,function(e,i){t.stopVideo(i,a)})),a.playingvideos.push(e)},s=function(e,t){null!=t.playingvideos&&t.playingvideos.splice(jQuery.inArray(e,t.playingvideos),1)}}(jQuery);